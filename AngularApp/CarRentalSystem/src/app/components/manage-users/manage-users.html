<h2>Manage Users</h2>

<form [formGroup]="userForm" (ngSubmit)="submitUser()" style="margin-bottom: 20px;">
  <mat-form-field appearance="fill" style="margin-right: 10px; width: 200px;">
    <mat-label>Username</mat-label>
    <input matInput formControlName="username" placeholder="Enter username">
  </mat-form-field>

  <mat-form-field appearance="fill" style="margin-right: 10px; width: 250px;">
    <mat-label>Email</mat-label>
    <input matInput formControlName="email" placeholder="Enter email">
  </mat-form-field>

  <mat-form-field appearance="fill" style="margin-right: 10px; width: 200px;">
    <mat-label>Password</mat-label>
    <input matInput formControlName="password" type="password" placeholder="Enter password">
  </mat-form-field>

  <mat-form-field appearance="fill" style="margin-right: 10px; width: 200px;">
    <mat-label>Role</mat-label>
    <mat-select formControlName="roles">
      <mat-option value="admin">Admin</mat-option>
      <mat-option value="agent">Agent</mat-option>
      <mat-option value="customer">Customer</mat-option>
    </mat-select>
  </mat-form-field>

  <div style="margin-top: 10px;">
    <button mat-raised-button color="primary" type="submit">
      {{ isEditMode ? 'Update' : 'Add' }} User
    </button>
    <button mat-stroked-button type="button" (click)="resetForm()">Reset</button>
  </div>
</form>

<mat-table [dataSource]="users" class="mat-elevation-z8" style="width: 100%;">

  <ng-container matColumnDef="uid">
    <mat-header-cell *matHeaderCellDef> UID </mat-header-cell>
    <mat-cell *matCellDef="let user"> {{ user.uid }} </mat-cell>
  </ng-container>

  
  <ng-container matColumnDef="username">
    <mat-header-cell *matHeaderCellDef> Username </mat-header-cell>
    <mat-cell *matCellDef="let user"> {{ user.username }} </mat-cell>
  </ng-container>


  <ng-container matColumnDef="email">
    <mat-header-cell *matHeaderCellDef> Email </mat-header-cell>
    <mat-cell *matCellDef="let user"> {{ user.email }} </mat-cell>
  </ng-container>


  <ng-container matColumnDef="roles">
    <mat-header-cell *matHeaderCellDef> Role </mat-header-cell>
    <mat-cell *matCellDef="let user">
      <span [ngClass]="{
        'role-badge-admin': user.roles === 'admin',
        'role-badge-agent': user.roles === 'agent',
        'role-badge-customer': user.roles === 'customer'
      }">
        {{ user.roles }}
      </span>
    </mat-cell>
  </ng-container>


  <ng-container matColumnDef="active">
    <mat-header-cell *matHeaderCellDef> Status </mat-header-cell>
    <mat-cell *matCellDef="let user">
      <span [style.color]="user.active ? 'green' : 'red'">
        {{ user.active ? 'Active' : 'Inactive' }}
      </span>
    </mat-cell>
  </ng-container>


  <ng-container matColumnDef="actions">
    <mat-header-cell *matHeaderCellDef> Actions </mat-header-cell>
    <mat-cell *matCellDef="let user">
      <button mat-icon-button color="primary" (click)="editUser(user)">
        <mat-icon>edit</mat-icon>
      </button>
      <button mat-icon-button color="warn" (click)="deleteUser(user.uid)">
        <mat-icon>delete</mat-icon>
      </button>
    </mat-cell>
  </ng-container>

  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
  <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
</mat-table>
